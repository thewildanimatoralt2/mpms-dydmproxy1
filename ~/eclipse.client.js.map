{"version":3,"file":"eclipse.client.js","sources":["webpack://eclipse/./node_modules/set-cookie-parser/lib/set-cookie.js","webpack://eclipse/./src/client/api/addeventlistener.ts","webpack://eclipse/./src/client/api/audio.ts","webpack://eclipse/./src/client/api/cookie.ts","webpack://eclipse/./src/client/api/document.ts","webpack://eclipse/./src/client/api/element.ts","webpack://eclipse/./src/client/api/eval.ts","webpack://eclipse/./src/client/api/fetch.ts","webpack://eclipse/./src/client/api/history.ts","webpack://eclipse/./src/client/api/importscripts.ts","webpack://eclipse/./src/client/api/navigator.ts","webpack://eclipse/./src/client/api/open.ts","webpack://eclipse/./src/client/api/origin.ts","webpack://eclipse/./src/client/api/performance.ts","webpack://eclipse/./src/client/api/postmessage.ts","webpack://eclipse/./src/client/api/style.ts","webpack://eclipse/./src/client/api/websocket.ts","webpack://eclipse/./src/client/api/worker.ts","webpack://eclipse/./src/client/api/xmlhttprequest.ts","webpack://eclipse/./src/client/document.ts","webpack://eclipse/./src/client/location.ts","webpack://eclipse/./src/client/scope.ts","webpack://eclipse/./src/client/window.ts","webpack://eclipse/./node_modules/@mercuryworkshop/bare-mux/dist/index.mjs","webpack://eclipse/./node_modules/@webreflection/idb-map/index.js","webpack://eclipse/./src/client/index.ts"],"sourcesContent":["\"use strict\";\n\nvar defaultParseOptions = {\n  decodeValues: true,\n  map: false,\n  silent: false,\n};\n\nfunction isNonEmptyString(str) {\n  return typeof str === \"string\" && !!str.trim();\n}\n\nfunction parseString(setCookieValue, options) {\n  var parts = setCookieValue.split(\";\").filter(isNonEmptyString);\n\n  var nameValuePairStr = parts.shift();\n  var parsed = parseNameValuePair(nameValuePairStr);\n  var name = parsed.name;\n  var value = parsed.value;\n\n  options = options\n    ? Object.assign({}, defaultParseOptions, options)\n    : defaultParseOptions;\n\n  try {\n    value = options.decodeValues ? decodeURIComponent(value) : value; // decode cookie value\n  } catch (e) {\n    console.error(\n      \"set-cookie-parser encountered an error while decoding a cookie with value '\" +\n        value +\n        \"'. Set options.decodeValues to false to disable this feature.\",\n      e\n    );\n  }\n\n  var cookie = {\n    name: name,\n    value: value,\n  };\n\n  parts.forEach(function (part) {\n    var sides = part.split(\"=\");\n    var key = sides.shift().trimLeft().toLowerCase();\n    var value = sides.join(\"=\");\n    if (key === \"expires\") {\n      cookie.expires = new Date(value);\n    } else if (key === \"max-age\") {\n      cookie.maxAge = parseInt(value, 10);\n    } else if (key === \"secure\") {\n      cookie.secure = true;\n    } else if (key === \"httponly\") {\n      cookie.httpOnly = true;\n    } else if (key === \"samesite\") {\n      cookie.sameSite = value;\n    } else if (key === \"partitioned\") {\n      cookie.partitioned = true;\n    } else {\n      cookie[key] = value;\n    }\n  });\n\n  return cookie;\n}\n\nfunction parseNameValuePair(nameValuePairStr) {\n  // Parses name-value-pair according to rfc6265bis draft\n\n  var name = \"\";\n  var value = \"\";\n  var nameValueArr = nameValuePairStr.split(\"=\");\n  if (nameValueArr.length > 1) {\n    name = nameValueArr.shift();\n    value = nameValueArr.join(\"=\"); // everything after the first =, joined by a \"=\" if there was more than one part\n  } else {\n    value = nameValuePairStr;\n  }\n\n  return { name: name, value: value };\n}\n\nfunction parse(input, options) {\n  options = options\n    ? Object.assign({}, defaultParseOptions, options)\n    : defaultParseOptions;\n\n  if (!input) {\n    if (!options.map) {\n      return [];\n    } else {\n      return {};\n    }\n  }\n\n  if (input.headers) {\n    if (typeof input.headers.getSetCookie === \"function\") {\n      // for fetch responses - they combine headers of the same type in the headers array,\n      // but getSetCookie returns an uncombined array\n      input = input.headers.getSetCookie();\n    } else if (input.headers[\"set-cookie\"]) {\n      // fast-path for node.js (which automatically normalizes header names to lower-case\n      input = input.headers[\"set-cookie\"];\n    } else {\n      // slow-path for other environments - see #25\n      var sch =\n        input.headers[\n          Object.keys(input.headers).find(function (key) {\n            return key.toLowerCase() === \"set-cookie\";\n          })\n        ];\n      // warn if called on a request-like object with a cookie header rather than a set-cookie header - see #34, 36\n      if (!sch && input.headers.cookie && !options.silent) {\n        console.warn(\n          \"Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning.\"\n        );\n      }\n      input = sch;\n    }\n  }\n  if (!Array.isArray(input)) {\n    input = [input];\n  }\n\n  if (!options.map) {\n    return input.filter(isNonEmptyString).map(function (str) {\n      return parseString(str, options);\n    });\n  } else {\n    var cookies = {};\n    return input.filter(isNonEmptyString).reduce(function (cookies, str) {\n      var cookie = parseString(str, options);\n      cookies[cookie.name] = cookie;\n      return cookies;\n    }, cookies);\n  }\n}\n\n/*\n  Set-Cookie header field-values are sometimes comma joined in one string. This splits them without choking on commas\n  that are within a single set-cookie field-value, such as in the Expires portion.\n\n  This is uncommon, but explicitly allowed - see https://tools.ietf.org/html/rfc2616#section-4.2\n  Node.js does this for every header *except* set-cookie - see https://github.com/nodejs/node/blob/d5e363b77ebaf1caf67cd7528224b651c86815c1/lib/_http_incoming.js#L128\n  React Native's fetch does this for *every* header, including set-cookie.\n\n  Based on: https://github.com/google/j2objc/commit/16820fdbc8f76ca0c33472810ce0cb03d20efe25\n  Credits to: https://github.com/tomball for original and https://github.com/chrusart for JavaScript implementation\n*/\nfunction splitCookiesString(cookiesString) {\n  if (Array.isArray(cookiesString)) {\n    return cookiesString;\n  }\n  if (typeof cookiesString !== \"string\") {\n    return [];\n  }\n\n  var cookiesStrings = [];\n  var pos = 0;\n  var start;\n  var ch;\n  var lastComma;\n  var nextStart;\n  var cookiesSeparatorFound;\n\n  function skipWhitespace() {\n    while (pos < cookiesString.length && /\\s/.test(cookiesString.charAt(pos))) {\n      pos += 1;\n    }\n    return pos < cookiesString.length;\n  }\n\n  function notSpecialChar() {\n    ch = cookiesString.charAt(pos);\n\n    return ch !== \"=\" && ch !== \";\" && ch !== \",\";\n  }\n\n  while (pos < cookiesString.length) {\n    start = pos;\n    cookiesSeparatorFound = false;\n\n    while (skipWhitespace()) {\n      ch = cookiesString.charAt(pos);\n      if (ch === \",\") {\n        // ',' is a cookie separator if we have later first '=', not ';' or ','\n        lastComma = pos;\n        pos += 1;\n\n        skipWhitespace();\n        nextStart = pos;\n\n        while (pos < cookiesString.length && notSpecialChar()) {\n          pos += 1;\n        }\n\n        // currently special character\n        if (pos < cookiesString.length && cookiesString.charAt(pos) === \"=\") {\n          // we found cookies separator\n          cookiesSeparatorFound = true;\n          // pos is inside the next cookie, so back up and return it.\n          pos = nextStart;\n          cookiesStrings.push(cookiesString.substring(start, lastComma));\n          start = pos;\n        } else {\n          // in param ',' or param separator ';',\n          // we continue from that comma\n          pos = lastComma + 1;\n        }\n      } else {\n        pos += 1;\n      }\n    }\n\n    if (!cookiesSeparatorFound || pos >= cookiesString.length) {\n      cookiesStrings.push(cookiesString.substring(start, cookiesString.length));\n    }\n  }\n\n  return cookiesStrings;\n}\n\nmodule.exports = parse;\nmodule.exports.parse = parse;\nmodule.exports.parseString = parseString;\nmodule.exports.splitCookiesString = splitCookiesString;\n","window.addEventListener = new Proxy(window.addEventListener, {\n\tapply(target, thisArg, [type, func, ...argArray]) {\n\t\tif ([\"message\", \"messageerror\"].includes(type)) {\n\t\t\tconst wrappedFunc = function (event) {\n\t\t\t\tObject.defineProperty(event, \"origin\", {\n\t\t\t\t\tvalue: new URL(self.__eclipse$rewrite.url.decode(window.location.href))\n\t\t\t\t\t\t.origin,\n\t\t\t\t});\n\n\t\t\t\treturn func.call(this, event);\n\t\t\t};\n\n\t\t\treturn Reflect.apply(target, thisArg, [type, wrappedFunc, ...argArray]);\n\t\t} else if (type == \"hashchange\") {\n\t\t\tconst wrappedFunc = function (event) {\n\t\t\t\tObject.defineProperty(event, \"newURL\", {\n\t\t\t\t\tvalue: self.__eclipse$rewrite.url.decode(event.newURL),\n\t\t\t\t});\n\t\t\t\tObject.defineProperty(event, \"oldURL\", {\n\t\t\t\t\tvalue: self.__eclipse$rewrite.url.decode(event.oldURL),\n\t\t\t\t});\n\n\t\t\t\treturn func.call(this, event);\n\t\t\t};\n\n\t\t\treturn Reflect.apply(target, thisArg, [type, wrappedFunc, ...argArray]);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, [type, func, ...argArray]);\n\t},\n});\n","window.Audio = new Proxy(window.Audio, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[0]) {\n\t\t\targArray[0] = self.__eclipse$rewrite.url.encode(\n\t\t\t\targArray[0],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n","import { parse } from \"set-cookie-parser\";\nimport IDBMap from \"@webreflection/idb-map\";\n\nconst originalCookieDescriptor = Object.getOwnPropertyDescriptor(\n\tDocument.prototype,\n\t\"cookie\"\n);\n\nObject.defineProperty(window.document, \"cookie\", {\n\tget() {\n\t\treturn originalCookieDescriptor.get.call(window.document);\n\t},\n\tasync set(cookie) {\n\t\tconst cookiesJar = new IDBMap(\n\t\t\tnew URL(self.__eclipse$rewrite.url.decode(window.location.href)).host,\n\t\t\t{\n\t\t\t\tdurability: \"relaxed\",\n\t\t\t\tprefix: \"@eclipse/cookies\",\n\t\t\t}\n\t\t);\n\n\t\tconst cookies = parse(cookie, {\n\t\t\tsilent: true,\n\t\t});\n\n\t\tfor (const cookie of cookies) {\n\t\t\tawait cookiesJar.set(cookie.name, cookie);\n\t\t}\n\n\t\tconst proxiedCookie = cookie;\n\t\toriginalCookieDescriptor.set.call(document, proxiedCookie);\n\t},\n});\n","window.document.open = new Proxy(window.document.open, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray.length === 3) {\n\t\t\treturn window.open(\n\t\t\t\tself.__eclipse$rewrite.url.encode(argArray[0], window.location.href)\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n\nObject.defineProperty(window.document, \"domain\", {\n\tget() {\n\t\treturn new URL(self.__eclipse$rewrite.url.decode(window.location.href))\n\t\t\t.host;\n\t},\n\tset(value) {\n\t\treturn value;\n\t},\n});\n\nconst originalDocumentbaseURI = window.document.baseURI;\nObject.defineProperty(window.document, \"baseURI\", {\n\tget() {\n\t\treturn self.__eclipse$rewrite.url.decode(originalDocumentbaseURI);\n\t},\n\tset(value) {\n\t\treturn value;\n\t},\n});\n\nconst originalDocumentdocumentURI = window.document.documentURI;\nObject.defineProperty(window.document, \"documentURI\", {\n\tget() {\n\t\treturn self.__eclipse$rewrite.url.decode(originalDocumentdocumentURI);\n\t},\n\tset(value) {\n\t\treturn value;\n\t},\n});\n\nconst originalDocumentreferrer = window.document.referrer;\nObject.defineProperty(window.document, \"referrer\", {\n\tget() {\n\t\treturn originalDocumentreferrer\n\t\t\t? self.__eclipse$rewrite.url.decode(originalDocumentreferrer)\n\t\t\t: originalDocumentreferrer;\n\t},\n\tset(value) {\n\t\treturn value;\n\t},\n});\n\nconst originalDocumentURL = window.document.URL;\nObject.defineProperty(window.document, \"URL\", {\n\tget() {\n\t\treturn self.__eclipse$rewrite.url.decode(originalDocumentURL);\n\t},\n\tset(value) {\n\t\treturn value;\n\t},\n});\n\nwindow.document.write = new Proxy(window.document.write, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[0]) {\n\t\t\targArray[0] = self.__eclipse$rewrite.html(\n\t\t\t\targArray[0],\n\t\t\t\twindow.location.href,\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n\nwindow.document.writeln = new Proxy(window.document.writeln, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[0]) {\n\t\t\targArray[0] = self.__eclipse$rewrite.html(\n\t\t\t\targArray[0],\n\t\t\t\twindow.location.href,\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n","import { createDocumentProxy } from \"../document.ts\";\nimport { createWindowProxy } from \"../window.ts\";\n\nconst htmlElements = new Set([\n\t\"HTMLElement\",\n\t\"HTMLAnchorElement\",\n\t\"HTMLAreaElement\",\n\t\"HTMLAudioElement\",\n\t\"HTMLBaseElement\",\n\t\"HTMLBodyElement\",\n\t\"HTMLBRElement\",\n\t\"HTMLButtonElement\",\n\t\"HTMLCanvasElement\",\n\t\"HTMLDataElement\",\n\t\"HTMLDataListElement\",\n\t\"HTMLDialogElement\",\n\t\"HTMLDivElement\",\n\t\"HTMLDListElement\",\n\t\"HTMLEmbedElement\",\n\t\"HTMLFieldSetElement\",\n\t\"HTMLFontElement\",\n\t\"HTMLFormElement\",\n\t\"HTMLFrameElement\",\n\t\"HTMLFrameSetElement\",\n\t\"HTMLHeadingElement\",\n\t\"HTMLHeadElement\",\n\t\"HTMLHRElement\",\n\t\"HTMLHtmlElement\",\n\t\"HTMLIFrameElement\",\n\t\"HTMLImageElement\",\n\t\"HTMLInputElement\",\n\t\"HTMLLabelElement\",\n\t\"HTMLLegendElement\",\n\t\"HTMLLIElement\",\n\t\"HTMLLinkElement\",\n\t\"HTMLMapElement\",\n\t\"HTMLMarqueeElement\",\n\t\"HTMLMediaElement\",\n\t\"HTMLMenuElement\",\n\t\"HTMLMetaElement\",\n\t\"HTMLMeterElement\",\n\t\"HTMLModElement\",\n\t\"HTMLObjectElement\",\n\t\"HTMLOListElement\",\n\t\"HTMLOptGroupElement\",\n\t\"HTMLOptionElement\",\n\t\"HTMLOutputElement\",\n\t\"HTMLParagraphElement\",\n\t\"HTMLParamElement\",\n\t\"HTMLPictureElement\",\n\t\"HTMLPreElement\",\n\t\"HTMLProgressElement\",\n\t\"HTMLQuoteElement\",\n\t\"HTMLScriptElement\",\n\t\"HTMLSelectElement\",\n\t\"HTMLSlotElement\",\n\t\"HTMLSourceElement\",\n\t\"HTMLSpanElement\",\n\t\"HTMLStyleElement\",\n\t\"HTMLTableCaptionElement\",\n\t\"HTMLTableCellElement\",\n\t\"HTMLTableColElement\",\n\t\"HTMLTableElement\",\n\t\"HTMLTableRowElement\",\n\t\"HTMLTableSectionElement\",\n\t\"HTMLTemplateElement\",\n\t\"HTMLTextAreaElement\",\n\t\"HTMLTimeElement\",\n\t\"HTMLTitleElement\",\n\t\"HTMLTrackElement\",\n\t\"HTMLUListElement\",\n\t\"HTMLUnknownElement\",\n\t\"HTMLVideoElement\",\n]);\nconst urlAttributes = new Set([\n\t\"href\",\n\t\"src\",\n\t\"action\",\n\t\"formaction\",\n\t\"ping\",\n\t\"profile\",\n\t\"movie\",\n\t\"poster\",\n\t\"background\",\n\t\"data\",\n]);\nconst deleteAttributes = new Set([\n\t\"http-equiv\",\n\t\"nonce\",\n\t\"integrity\",\n\t\"crossorigin\",\n\t\"sandbox\",\n\t\"csp\",\n]);\nconst srcSetAttributes = new Set([\"srcset\", \"imagesrcset\"]);\nconst htmlAttributes = new Set([\"srcdoc\"]);\nconst cssAttributes = new Set([\"style\"]);\nconst javascriptAttributes = new Set([\n\t\"onafterprint\",\n\t\"onbeforeprint\",\n\t\"onbeforeunload\",\n\t\"onerror\",\n\t\"onhashchange\",\n\t\"onload\",\n\t\"onmessage\",\n\t\"onoffline\",\n\t\"ononline\",\n\t\"onpagehide\",\n\t\"onpopstate\",\n\t\"onstorage\",\n\t\"onunload\",\n\t\"onblur\",\n\t\"onchange\",\n\t\"oncontextmenu\",\n\t\"onfocus\",\n\t\"oninput\",\n\t\"oninvalid\",\n\t\"onreset\",\n\t\"onsearch\",\n\t\"onselect\",\n\t\"onsubmit\",\n\t\"onkeydown\",\n\t\"onkeypress\",\n\t\"onkeyup\",\n\t\"onclick\",\n\t\"ondblclick\",\n\t\"onmousedown\",\n\t\"onmousemove\",\n\t\"onmouseout\",\n\t\"onmouseover\",\n\t\"onmouseup\",\n\t\"onmousewheel\",\n\t\"onwheel\",\n\t\"ondrag\",\n\t\"ondragend\",\n\t\"ondragenter\",\n\t\"ondragleave\",\n\t\"ondragover\",\n\t\"ondragstart\",\n\t\"ondrop\",\n\t\"onscroll\",\n\t\"oncopy\",\n\t\"oncut\",\n\t\"onpaste\",\n\t\"onabort\",\n\t\"oncanplay\",\n\t\"oncanplaythrough\",\n\t\"oncuechange\",\n\t\"ondurationchange\",\n\t\"onemptied\",\n\t\"onended\",\n\t\"onerror\",\n\t\"onloadeddata\",\n\t\"onloadedmetadata\",\n\t\"onloadstart\",\n\t\"onpause\",\n\t\"onplay\",\n\t\"onplaying\",\n\t\"onprogress\",\n\t\"onratechange\",\n\t\"onseeked\",\n\t\"onseeking\",\n\t\"onstalled\",\n\t\"onsuspend\",\n\t\"ontimeupdate\",\n\t\"onvolumechange\",\n\t\"onwaiting\",\n]);\nconst allAttributes = new Set([\n\t...urlAttributes,\n\t...deleteAttributes,\n\t...srcSetAttributes,\n\t...htmlAttributes,\n\t...javascriptAttributes,\n]);\n\nObject.defineProperty(Node.prototype, \"baseURI\", {\n\tget() {\n\t\treturn window.document.baseURI;\n\t},\n});\n\nconst originalElementInnerHTML = Object.getOwnPropertyDescriptor(\n\tElement.prototype,\n\t\"innerHTML\"\n);\nObject.defineProperty(Element.prototype, \"innerHTML\", {\n\tset(value) {\n\t\tif (this instanceof HTMLScriptElement) {\n\t\t\toriginalElementInnerHTML.set.call(\n\t\t\t\tthis,\n\t\t\t\tself.__eclipse$rewrite.javascript(value, window.location.href)\n\t\t\t);\n\t\t} else if (this instanceof HTMLStyleElement) {\n\t\t\toriginalElementInnerHTML.set.call(\n\t\t\t\tthis,\n\t\t\t\tself.__eclipse$rewrite.css(value, \"stylesheet\", window.location.href)\n\t\t\t);\n\t\t} else {\n\t\t\toriginalElementInnerHTML.set.call(\n\t\t\t\tthis,\n\t\t\t\tself.__eclipse$rewrite.html(value, window.location.href, true)\n\t\t\t);\n\t\t}\n\n\t\treturn value;\n\t},\n\tget() {\n\t\treturn originalElementInnerHTML.get.call(this);\n\t},\n});\n\nconst originalElementInnerText = Object.getOwnPropertyDescriptor(\n\tElement.prototype,\n\t\"innerText\"\n);\nObject.defineProperty(Element.prototype, \"innerText\", {\n\tset(value) {\n\t\tif (this instanceof HTMLScriptElement) {\n\t\t\toriginalElementInnerText.set.call(\n\t\t\t\tthis,\n\t\t\t\tself.__eclipse$rewrite.javascript(value, window.location.href)\n\t\t\t);\n\t\t} else if (this instanceof HTMLStyleElement) {\n\t\t\toriginalElementInnerText.set.call(\n\t\t\t\tthis,\n\t\t\t\tself.__eclipse$rewrite.css(value, \"stylesheet\", window.location.href)\n\t\t\t);\n\t\t} else {\n\t\t\toriginalElementInnerText.set.call(this, value);\n\t\t}\n\n\t\treturn value;\n\t},\n\tget() {\n\t\treturn originalElementInnerText.get.call(this);\n\t},\n});\n\nconst originalElementHasAttribute = HTMLElement.prototype.hasAttribute;\nObject.defineProperty(Element.prototype, \"hasAttribute\", {\n\tvalue: function (attribute) {\n\t\tif (attribute.startsWith(\"data-eclipse-attr-\")) {\n\t\t\treturn null;\n\t\t} else {\n\t\t\treturn originalElementHasAttribute.call(this, attribute);\n\t\t}\n\t},\n});\n\nconst originalElementGetAttribute = HTMLElement.prototype.getAttribute;\nObject.defineProperty(Element.prototype, \"getAttribute\", {\n\tvalue: function (attribute) {\n\t\tif (attribute.startsWith(\"data-eclipse-attr-\")) {\n\t\t\treturn null;\n\t\t} else if (\n\t\t\toriginalElementHasAttribute.call(this, `data-eclipse-attr-${attribute}`)\n\t\t) {\n\t\t\treturn originalElementGetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\t`data-eclipse-attr-${attribute}`\n\t\t\t);\n\t\t} else {\n\t\t\treturn originalElementGetAttribute.call(this, attribute);\n\t\t}\n\t},\n});\n\nconst originalElementSetAttribute = HTMLElement.prototype.setAttribute;\nObject.defineProperty(Element.prototype, \"setAttribute\", {\n\tvalue: function (name, value) {\n\t\tif (urlAttributes.has(name)) {\n\t\t\toriginalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\t`data-eclipse-attr-${name}`,\n\t\t\t\tvalue\n\t\t\t);\n\t\t\treturn originalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\tname,\n\t\t\t\tvalue ? self.__eclipse$rewrite.url.encode(value, window.location.href) : \"\"\n\t\t\t);\n\t\t} else if (deleteAttributes.has(name)) {\n\t\t\treturn originalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\t`data-eclipse-attr-${name}`,\n\t\t\t\tvalue\n\t\t\t);\n\t\t} else if (srcSetAttributes.has(name)) {\n\t\t\toriginalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\t`data-eclipse-attr-${name}`,\n\t\t\t\tvalue\n\t\t\t);\n\t\t\treturn originalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\tname,\n\t\t\t\tvalue ? self.__eclipse$rewrite.srcset(value, window.location.href) : \"\"\n\t\t\t);\n\t\t} else if (htmlAttributes.has(name)) {\n\t\t\toriginalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\t`data-eclipse-attr-${name}`,\n\t\t\t\tvalue\n\t\t\t);\n\t\t\treturn originalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\tname,\n\t\t\t\tvalue ? self.__eclipse$rewrite.html(value, window.location.href) : \"\"\n\t\t\t);\n\t\t} else if (cssAttributes.has(name)) {\n\t\t\toriginalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\t`data-eclipse-attr-${name}`,\n\t\t\t\tvalue\n\t\t\t);\n\t\t\treturn originalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\tname,\n\t\t\t\tvalue\n\t\t\t\t\t? self.__eclipse$rewrite.css(\n\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\t\"declarationList\",\n\t\t\t\t\t\t\twindow.location.href\n\t\t\t\t\t  )\n\t\t\t\t\t: \"\"\n\t\t\t);\n\t\t} else if (javascriptAttributes.has(name)) {\n\t\t\toriginalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\t`data-eclipse-attr-${name}`,\n\t\t\t\tvalue\n\t\t\t);\n\t\t\treturn originalElementSetAttribute.call(\n\t\t\t\tthis,\n\t\t\t\tname,\n\t\t\t\tvalue ? self.__eclipse$rewrite.javascript(value, window.location.href) : \"\"\n\t\t\t);\n\t\t} else {\n\t\t\treturn originalElementSetAttribute.call(this, name, value);\n\t\t}\n\t},\n});\n\nconst originalElementRemoveAttribute = HTMLElement.prototype.removeAttribute;\nObject.defineProperty(Element.prototype, \"removeAttribute\", {\n\tvalue: function (attribute) {\n\t\tif (\n\t\t\toriginalElementHasAttribute.call(this, `data-eclipse-attr-${attribute}`)\n\t\t) {\n\t\t\toriginalElementRemoveAttribute.call(\n\t\t\t\tthis,\n\t\t\t\t`data-eclipse-attr-${attribute}`\n\t\t\t);\n\t\t}\n\t\treturn originalElementRemoveAttribute.call(this, attribute);\n\t},\n});\n\nconst originalElementGetAttributeNames = HTMLElement.prototype.getAttributeNames;\nObject.defineProperty(Element.prototype, \"getAttributeNames\", {\n\tvalue: function () {\n\t\tconst attributes = originalElementGetAttributeNames\n\t\t\t.call(this)\n\t\t\t.filter((attr) => !attr.startsWith(\"data-eclipse-attr\"));\n\t\treturn attributes;\n\t},\n});\n\nfor (const htmlElement of htmlElements) {\n\tif (window.hasOwnProperty(htmlElement)) {\n\t\tfor (const attribute of allAttributes) {\n\t\t\tif (window[htmlElement].prototype.hasOwnProperty(attribute)) {\n\t\t\t\tObject.defineProperty(window[htmlElement].prototype, attribute, {\n\t\t\t\t\tset(value) {\n\t\t\t\t\t\treturn this.setAttribute(attribute, value);\n\t\t\t\t\t},\n\t\t\t\t\tget() {\n\t\t\t\t\t\treturn this.getAttribute(attribute);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\n//getAttributeNS getAttributeNode getAttributeNodeNS setAttributeNS setAttributeNode setAttributeNodeNS outerHTML outerText insertAdjacentHTML insertAdjacentText\n//HTMLAnchorElement.prototype.origin (document.querySelector(\"a\").origin) (also other url properties like pathname etc.)\n\nconst originalContentWindow = Object.getOwnPropertyDescriptor(\n\tHTMLIFrameElement.prototype,\n\t\"contentWindow\"\n).get;\nObject.defineProperty(HTMLIFrameElement.prototype, \"contentWindow\", {\n\tget: function () {\n\t\treturn createWindowProxy(originalContentWindow.call(this));\n\t},\n});\n\nconst originalContentDocument = Object.getOwnPropertyDescriptor(\n\tHTMLIFrameElement.prototype,\n\t\"contentDocument\"\n).get;\nObject.defineProperty(HTMLIFrameElement.prototype, \"contentDocument\", {\n\tget: function () {\n\t\treturn createDocumentProxy(originalContentDocument.call(this));\n\t},\n});\n","window.eval = new Proxy(window.eval, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[0]) {\n\t\t\targArray[0] = self.__eclipse$rewrite.javascript(\n\t\t\t\targArray[0],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n\nwindow.Function = new Proxy(window.Function, {\n\tconstruct(target, argArray) {\n\t\tif (argArray[argArray.length - 1]) {\n\t\t\targArray[argArray.length - 1] = self.__eclipse$rewrite.javascript(\n\t\t\t\targArray[argArray.length - 1],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.construct(target, argArray);\n\t},\n});\n","window.fetch = new Proxy(window.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[0]) {\n\t\t\targArray[0] = self.__eclipse$rewrite.url.encode(\n\t\t\t\targArray[0],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n","window.history.pushState = new Proxy(window.history.pushState, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[2]) {\n\t\t\targArray[2] = self.__eclipse$rewrite.url.encode(\n\t\t\t\targArray[2],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n\nwindow.history.replaceState = new Proxy(window.history.replaceState, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[2]) {\n\t\t\targArray[2] = self.__eclipse$rewrite.url.encode(\n\t\t\t\targArray[2],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n","if (\"importScripts\" in self) {\n\tself.importScripts = new Proxy(self.importScripts, {\n\t\tapply(target, thisArg, argArray) {\n\t\t\tif (argArray) {\n\t\t\t\targArray = argArray.map((arg) =>\n\t\t\t\t\tself.__eclipse$rewrite.url.encode(arg, self.location.href)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn Reflect.apply(target, thisArg, argArray);\n\t\t},\n\t});\n}\n","window.navigator.sendBeacon = new Proxy(window.navigator.sendBeacon, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[0]) {\n\t\t\targArray[0] = self.__eclipse$rewrite.url.encode(\n\t\t\t\targArray[0],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n\nwindow.navigator.serviceWorker.register = new Proxy(\n\twindow.navigator.serviceWorker.register,\n\t{\n\t\tapply(target, thisArg, argArray) {\n\t\t\tif (argArray[0]) {\n\t\t\t\targArray[0] = self.__eclipse$rewrite.url.encode(\n\t\t\t\t\targArray[0],\n\t\t\t\t\twindow.location.href\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (argArray[1]) {\n\t\t\t\tif (typeof argArray[1] == \"object\" && !Array.isArray(argArray[1])) {\n\t\t\t\t\tif (argArray[1].scope) {\n\t\t\t\t\t\targArray[1].scope = self.__eclipse$rewrite.url.encode(\n\t\t\t\t\t\t\targArray[1].scope,\n\t\t\t\t\t\t\twindow.location.href\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn Reflect.apply(target, thisArg, argArray);\n\t\t},\n\t}\n);\n","window.open = new Proxy(window.open, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[0]) {\n\t\t\targArray[0] = self.__eclipse$rewrite.url.encode(\n\t\t\t\targArray[0],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n","Object.defineProperty(window, \"origin\", {\n\tget() {\n\t\treturn new URL(self.__eclipse$rewrite.url.decode(window.location.href))\n\t\t\t.origin;\n\t},\n\tset(value) {\n\t\treturn value;\n\t},\n});\n","const originalGetEntriesByType = window.performance.getEntriesByType;\n\nwindow.performance.getEntriesByType = function (type) {\n\tconst entries = originalGetEntriesByType.call(this, type);\n\n\tif ([\"navigation\", \"resource\"].includes(type)) {\n\t\treturn entries.map((entry) => {\n\t\t\treturn {\n\t\t\t\t...entry,\n\t\t\t\tname: self.__eclipse$rewrite.url.decode(entry.name),\n\t\t\t};\n\t\t});\n\t}\n\n\treturn entries;\n};\n","window.postMessage = new Proxy(window.postMessage, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[1]) {\n\t\t\targArray[1] = self.__eclipse$rewrite.url.encode(\n\t\t\t\targArray[0],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n","const originalElementStyle = Object.getOwnPropertyDescriptor(\n\tHTMLElement.prototype,\n\t\"style\"\n);\n\nObject.defineProperty(HTMLElement.prototype, \"style\", {\n\tget() {\n\t\tconst styles = originalElementStyle.get.call(this);\n\n\t\treturn new Proxy(styles, {\n\t\t\tget(target, property) {\n\t\t\t\tconst value = target[property];\n\n\t\t\t\tif (typeof value == \"function\") {\n\t\t\t\t\treturn value.bind(target);\n\t\t\t\t}\n\n\t\t\t\tconst urlRegex = /url\\([\"']?([^)\"']+)[\"']?\\)/;\n\t\t\t\tif (urlRegex.test(value)) {\n\t\t\t\t\treturn value.replace(urlRegex, (match, url) => {\n\t\t\t\t\t\treturn `url(${self.__eclipse$rewrite.url.decode(url)})`;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tset(target, property, value) {\n\t\t\t\tconst urlRegex = /url\\([\"']?([^)\"']+)[\"']?\\)/;\n\t\t\t\tif (urlRegex.test(value)) {\n\t\t\t\t\ttarget[property] = value.replace(urlRegex, (match, url) => {\n\t\t\t\t\t\treturn `url(${self.__eclipse$rewrite.url.encode(\n\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\twindow.location.href\n\t\t\t\t\t\t)})`;\n\t\t\t\t\t});\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\ttarget[property] = value;\n\t\t\t\treturn true;\n\t\t\t},\n\t\t});\n\t},\n});\n\nconst originalGetProperty = CSSStyleDeclaration.prototype.getPropertyValue;\nCSSStyleDeclaration.prototype.getPropertyValue = function (property) {\n\tconst value = originalGetProperty.call(this, property);\n\n\tconst urlRegex = /url\\([\"']?([^)\"']+)[\"']?\\)/;\n\tif (urlRegex.test(value)) {\n\t\treturn value.replace(urlRegex, (match, url) => {\n\t\t\treturn `url(${self.__eclipse$rewrite.url.decode(url)})`;\n\t\t});\n\t}\n\n\treturn value;\n};\n\n//setProperty\n//cssText\n","import { BareClient } from \"@mercuryworkshop/bare-mux\";\n\nconst client: BareClient = new BareClient();\n\nwindow.WebSocket = new Proxy(window.WebSocket, {\n\tconstruct(target, args) {\n\t\treturn client.createWebSocket(\n\t\t\targs[0],\n\t\t\targs[1],\n\t\t\ttarget,\n\t\t\t{\n\t\t\t\t\"User-Agent\": navigator.userAgent,\n\t\t\t},\n\t\t\tArrayBuffer.prototype\n\t\t);\n\t},\n});\n","window.Worker = new Proxy(window.Worker, {\n\tconstruct(target, argArray) {\n\t\tif (argArray[0]) {\n\t\t\targArray[0] = self.__eclipse$rewrite.url.encode(\n\t\t\t\targArray[0],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.construct(target, argArray);\n\t},\n});\n\nWorklet.prototype.addModule = new Proxy(Worklet.prototype.addModule, {\n\tapply(target, thisArg, argArray) {\n\t\tif (argArray[0]) {\n\t\t\targArray[0] = self.__eclipse$rewrite.url.encode(\n\t\t\t\targArray[0],\n\t\t\t\twindow.location.href\n\t\t\t);\n\t\t}\n\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n","window.XMLHttpRequest.prototype.open = new Proxy(\n\twindow.XMLHttpRequest.prototype.open,\n\t{\n\t\tapply(target, thisArg, argArray) {\n\t\t\tif (argArray[1]) {\n\t\t\t\targArray[1] = self.__eclipse$rewrite.url.encode(\n\t\t\t\t\targArray[1],\n\t\t\t\t\twindow.location.href\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn Reflect.apply(target, thisArg, argArray);\n\t\t},\n\t}\n);\n","import { createLocationProxy } from \"./location.ts\";\nimport { createWindowProxy } from \"./window.ts\";\n\nfunction createDocumentProxy(doc: Document = window.document): any {\n\treturn new Proxy(doc, {\n\t\tget(target, prop) {\n\t\t\tconst value: any = target[prop];\n\n\t\t\tif (prop == \"location\") {\n\t\t\t\treturn createLocationProxy(value);\n\t\t\t} else if (prop == \"defaultView\") {\n\t\t\t\treturn createWindowProxy(value);\n\t\t\t}\n\n\t\t\tif (typeof value == \"function\") {\n\t\t\t\treturn value.bind(target);\n\t\t\t} else {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t},\n\t\tset(target, prop, newValue) {\n\t\t\ttarget[prop] = newValue;\n\t\t\treturn true;\n\t\t},\n\t});\n}\n\nexport { createDocumentProxy };\n","function createLocationProxy(loc: Location = window.location): any {\n\treturn new Proxy(\n\t\t{},\n\t\t{\n\t\t\tget(_target, prop) {\n\t\t\t\tconst decodedLocation: URL = new URL(\n\t\t\t\t\tself.__eclipse$rewrite.url.decode(loc.href)\n\t\t\t\t);\n\n\t\t\t\tswitch (prop) {\n\t\t\t\t\tcase \"constructor\":\n\t\t\t\t\t\treturn loc.constructor;\n\t\t\t\t\tcase \"assign\":\n\t\t\t\t\t\treturn (url) =>\n\t\t\t\t\t\t\tloc.assign(\n\t\t\t\t\t\t\t\tself.self.__eclipse$rewrite.url.encode(\n\t\t\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\t\t\twindow.location.href\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\tcase \"reload\":\n\t\t\t\t\t\treturn () => loc.reload();\n\t\t\t\t\tcase \"replace\":\n\t\t\t\t\t\treturn (url) =>\n\t\t\t\t\t\t\tloc.replace(\n\t\t\t\t\t\t\t\tself.__eclipse$rewrite.url.encode(url, window.location.href)\n\t\t\t\t\t\t\t);\n\t\t\t\t\tcase \"toString\":\n\t\t\t\t\t\treturn () => decodedLocation.toString();\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn decodedLocation[prop];\n\t\t\t\t}\n\t\t\t},\n\t\t\tset(_target, prop, value) {\n\t\t\t\tconst decodedLocation: URL = new URL(\n\t\t\t\t\tself.__eclipse$rewrite.url.decode(loc.href)\n\t\t\t\t);\n\n\t\t\t\tif (prop in decodedLocation) {\n\t\t\t\t\tdecodedLocation[prop] = new URL(\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\tdecodedLocation.href\n\t\t\t\t\t).toString();\n\t\t\t\t\tloc.href = self.__eclipse$rewrite.url.encode(\n\t\t\t\t\t\tdecodedLocation.href,\n\t\t\t\t\t\twindow.location.href\n\t\t\t\t\t);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t}\n\t);\n}\n\nexport { createLocationProxy };\n","import { createWindowProxy } from \"./window.ts\";\nimport { createLocationProxy } from \"./location.ts\";\nimport { createDocumentProxy } from \"./document.ts\";\n\nfunction scope(identifier: any): any {\n\tconst globals: Array<string> = [\n\t\t\"window\",\n\t\t\"self\",\n\t\t\"globalThis\",\n\t\t\"parent\",\n\t\t\"top\",\n\t\t\"document\",\n\t\t\"frames\",\n\t];\n\n\tif (\n\t\tglobals.filter((global: string) =>\n\t\t\twindow[global].Window\n\t\t\t\t? identifier instanceof window[global].Window\n\t\t\t\t: false\n\t\t).length > 0\n\t) {\n\t\treturn createWindowProxy(identifier);\n\t} else if (identifier instanceof Location) {\n\t\treturn createLocationProxy(identifier);\n\t} else if (identifier instanceof Document) {\n\t\treturn createDocumentProxy(identifier);\n\t}\n\n\treturn identifier;\n}\n\nself.__eclipse$scope = new Proxy(\n\t{},\n\t{\n\t\tget(_target, prop: string) {\n\t\t\treturn scope(self[prop]);\n\t\t},\n        //@ts-ignore\n        set(target, prop, newValue) {\n\t\t\tif (prop == \"location\") {\n                //@ts-ignore\n\t\t\t\treturn (window.location = self.__eclipse$rewrite.url.encode(\n\t\t\t\t\tnewValue,\n\t\t\t\t\twindow.location.href\n\t\t\t\t));\n\t\t\t}\n\t\t\ttarget[prop] = newValue;\n\t\t\treturn true;\n\t\t},\n\t}\n);\n","import { createDocumentProxy } from \"./document.ts\";\nimport { createLocationProxy } from \"./location.ts\";\n\nfunction createWindowProxy(win: Window = window): any {\n\treturn new Proxy(win, {\n\t\tget(target, prop: string) {\n\t\t\tconst value: any = target[prop];\n\n\t\t\tif (prop == \"location\") {\n\t\t\t\treturn createLocationProxy(value);\n\t\t\t} else if (prop == \"document\") {\n\t\t\t\treturn createDocumentProxy(value);\n\t\t\t} else if (\n\t\t\t\t[\"window\", \"self\", \"globalThis\", \"parent\", \"top\", \"frames\"].includes(\n\t\t\t\t\tprop\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn createWindowProxy(value);\n\t\t\t}\n\n\t\t\tif (typeof value == \"function\") {\n\t\t\t\treturn value.bind(target);\n\t\t\t} else {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t},\n\t\t//@ts-ignore\n\t\tset(target, prop, newValue) {\n\t\t\tif (prop == \"location\") {\n\t\t\t\treturn (win.location = self.__eclipse$rewrite.url.encode(\n\t\t\t\t\tnewValue,\n\t\t\t\t\twindow.location.href\n\t\t\t\t));\n\t\t\t}\n\t\t\ttarget[prop] = newValue;\n\t\t\treturn true;\n\t\t},\n\t});\n}\n\nexport { createWindowProxy };\n","const e=20,t=globalThis.fetch,r=globalThis.SharedWorker,a=globalThis.localStorage,s=globalThis.navigator.serviceWorker,o=MessagePort.prototype.postMessage,n={prototype:{send:WebSocket.prototype.send},CLOSED:WebSocket.CLOSED,CLOSING:WebSocket.CLOSING,CONNECTING:WebSocket.CONNECTING,OPEN:WebSocket.OPEN};async function c(){const e=(await self.clients.matchAll({type:\"window\",includeUncontrolled:!0})).map((async e=>{const t=await function(e){let t=new MessageChannel;return new Promise((r=>{e.postMessage({type:\"getPort\",port:t.port2},[t.port2]),t.port1.onmessage=e=>{r(e.data)}}))}(e);return await i(t),t})),t=Promise.race([Promise.any(e),new Promise(((e,t)=>setTimeout(t,1e3,new TypeError(\"timeout\"))))]);try{return await t}catch(e){if(e instanceof AggregateError)throw console.error(\"bare-mux: failed to get a bare-mux SharedWorker MessagePort as all clients returned an invalid MessagePort.\"),new Error(\"All clients returned an invalid MessagePort.\");return console.warn(\"bare-mux: failed to get a bare-mux SharedWorker MessagePort within 1s, retrying\"),await c()}}function i(e){const t=new MessageChannel,r=new Promise(((e,r)=>{t.port1.onmessage=t=>{\"pong\"===t.data.type&&e()},setTimeout(r,1500)}));return o.call(e,{message:{type:\"ping\"},port:t.port2},[t.port2]),r}function l(e,t){const a=new r(e,\"bare-mux-worker\");return t&&s.addEventListener(\"message\",(t=>{if(\"getPort\"===t.data.type&&t.data.port){console.debug(\"bare-mux: recieved request for port from sw\");const a=new r(e,\"bare-mux-worker\");o.call(t.data.port,a.port,[a.port])}})),a.port}let h=null;function d(){if(null===h){const e=new MessageChannel,t=new ReadableStream;let r;try{o.call(e.port1,t,[t]),r=!0}catch(e){r=!1}return h=r,r}return h}class p{constructor(e){this.channel=new BroadcastChannel(\"bare-mux\"),e instanceof MessagePort||e instanceof Promise?this.port=e:this.createChannel(e,!0)}createChannel(e,t){if(self.clients)this.port=c(),this.channel.onmessage=e=>{\"refreshPort\"===e.data.type&&(this.port=c())};else if(e&&SharedWorker){if(!e.startsWith(\"/\")&&!e.includes(\"://\"))throw new Error(\"Invalid URL. Must be absolute or start at the root.\");this.port=l(e,t),console.debug(\"bare-mux: setting localStorage bare-mux-path to\",e),a[\"bare-mux-path\"]=e}else{if(!SharedWorker)throw new Error(\"Unable to get a channel to the SharedWorker.\");{const e=a[\"bare-mux-path\"];if(console.debug(\"bare-mux: got localStorage bare-mux-path:\",e),!e)throw new Error(\"Unable to get bare-mux workerPath from localStorage.\");this.port=l(e,t)}}}async sendMessage(e,t){this.port instanceof Promise&&(this.port=await this.port);try{await i(this.port)}catch{return console.warn(\"bare-mux: Failed to get a ping response from the worker within 1.5s. Assuming port is dead.\"),this.createChannel(),await this.sendMessage(e,t)}const r=new MessageChannel,a=[r.port2,...t||[]],s=new Promise(((e,t)=>{r.port1.onmessage=r=>{const a=r.data;\"error\"===a.type?t(a.error):e(a)}}));return o.call(this.port,{message:e,port:r.port2},a),await s}}class w extends EventTarget{constructor(e,t=[],r,a){super(),this.protocols=t,this.readyState=n.CONNECTING,this.url=e.toString(),this.protocols=t;const s=e=>{this.protocols=e,this.readyState=n.OPEN;const t=new Event(\"open\");this.dispatchEvent(t)},o=async e=>{const t=new MessageEvent(\"message\",{data:e});this.dispatchEvent(t)},c=(e,t)=>{this.readyState=n.CLOSED;const r=new CloseEvent(\"close\",{code:e,reason:t});this.dispatchEvent(r)},i=()=>{this.readyState=n.CLOSED;const e=new Event(\"error\");this.dispatchEvent(e)};this.channel=new MessageChannel,this.channel.port1.onmessage=e=>{\"open\"===e.data.type?s(e.data.args[0]):\"message\"===e.data.type?o(e.data.args[0]):\"close\"===e.data.type?c(e.data.args[0],e.data.args[1]):\"error\"===e.data.type&&i()},r.sendMessage({type:\"websocket\",websocket:{url:e.toString(),protocols:t,requestHeaders:a,channel:this.channel.port2}},[this.channel.port2])}send(...e){if(this.readyState===n.CONNECTING)throw new DOMException(\"Failed to execute 'send' on 'WebSocket': Still in CONNECTING state.\");let t=e[0];t.buffer&&(t=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)),o.call(this.channel.port1,{type:\"data\",data:t},t instanceof ArrayBuffer?[t]:[])}close(e,t){o.call(this.channel.port1,{type:\"close\",closeCode:e,closeReason:t})}}function u(e,t,r){console.error(`error while processing '${r}': `,t),e.postMessage({type:\"error\",error:t})}function g(e){for(let t=0;t<e.length;t++){const r=e[t];if(!\"!#$%&'*+-.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ^_`abcdefghijklmnopqrstuvwxyz|~\".includes(r))return!1}return!0}const f=[\"ws:\",\"wss:\"],y=[101,204,205,304],b=[301,302,303,307,308];class m{constructor(e){this.worker=new p(e)}async getTransport(){return(await this.worker.sendMessage({type:\"get\"})).name}async setTransport(e,t,r){await this.setManualTransport(`\\n\\t\\t\\tconst { default: BareTransport } = await import(\"${e}\");\\n\\t\\t\\treturn [BareTransport, \"${e}\"];\\n\\t\\t`,t,r)}async setManualTransport(e,t,r){if(\"bare-mux-remote\"===e)throw new Error(\"Use setRemoteTransport.\");await this.worker.sendMessage({type:\"set\",client:{function:e,args:t}},r)}async setRemoteTransport(e,t){const r=new MessageChannel;r.port1.onmessage=async t=>{const r=t.data.port,a=t.data.message;if(\"fetch\"===a.type)try{e.ready||await e.init(),await async function(e,t,r){const a=await r.request(new URL(e.fetch.remote),e.fetch.method,e.fetch.body,e.fetch.headers,null);if(!d()&&a.body instanceof ReadableStream){const e=new Response(a.body);a.body=await e.arrayBuffer()}a.body instanceof ReadableStream||a.body instanceof ArrayBuffer?o.call(t,{type:\"fetch\",fetch:a},[a.body]):o.call(t,{type:\"fetch\",fetch:a})}(a,r,e)}catch(e){u(r,e,\"fetch\")}else if(\"websocket\"===a.type)try{e.ready||await e.init(),await async function(e,t,r){const[a,s]=r.connect(new URL(e.websocket.url),e.websocket.protocols,e.websocket.requestHeaders,(t=>{o.call(e.websocket.channel,{type:\"open\",args:[t]})}),(t=>{t instanceof ArrayBuffer?o.call(e.websocket.channel,{type:\"message\",args:[t]},[t]):o.call(e.websocket.channel,{type:\"message\",args:[t]})}),((t,r)=>{o.call(e.websocket.channel,{type:\"close\",args:[t,r]})}),(t=>{o.call(e.websocket.channel,{type:\"error\",args:[t]})}));e.websocket.channel.onmessage=e=>{\"data\"===e.data.type?a(e.data.data):\"close\"===e.data.type&&s(e.data.closeCode,e.data.closeReason)},o.call(t,{type:\"websocket\"})}(a,r,e)}catch(e){u(r,e,\"websocket\")}},await this.worker.sendMessage({type:\"set\",client:{function:\"bare-mux-remote\",args:[r.port2,t]}},[r.port2])}getInnerPort(){return this.worker.port}}class k{constructor(e){this.worker=new p(e)}createWebSocket(e,t=[],r,a){try{e=new URL(e)}catch(t){throw new DOMException(`Faiiled to construct 'WebSocket': The URL '${e}' is invalid.`)}if(!f.includes(e.protocol))throw new DOMException(`Failed to construct 'WebSocket': The URL's scheme must be either 'ws' or 'wss'. '${e.protocol}' is not allowed.`);Array.isArray(t)||(t=[t]),t=t.map(String);for(const e of t)if(!g(e))throw new DOMException(`Failed to construct 'WebSocket': The subprotocol '${e}' is invalid.`);a=a||{};return new w(e,t,this.worker,a)}async fetch(e,r){const a=new Request(e,r),s=r?.headers||a.headers,o=s instanceof Headers?Object.fromEntries(s):s,n=a.body;let c=new URL(a.url);if(c.protocol.startsWith(\"blob:\")){const e=await t(c),r=new Response(e.body,e);return r.rawHeaders=Object.fromEntries(e.headers),r.rawResponse=e,r}for(let e=0;;e++){let t=(await this.worker.sendMessage({type:\"fetch\",fetch:{remote:c.toString(),method:a.method,headers:o,body:n||void 0}},n?[n]:[])).fetch,s=new Response(y.includes(t.status)?void 0:t.body,{headers:new Headers(t.headers),status:t.status,statusText:t.statusText});s.rawHeaders=t.headers,s.finalURL=c.toString();const i=r?.redirect||a.redirect;if(!b.includes(s.status))return s;switch(i){case\"follow\":{const t=s.headers.get(\"location\");if(20>e&&null!==t){c=new URL(t,c);continue}throw new TypeError(\"Failed to fetch\")}case\"error\":throw new TypeError(\"Failed to fetch\");case\"manual\":return s}}}}console.debug(\"bare-mux: running v2.1.6 (build 4b7607b)\");export{k as BareClient,m as BareMuxConnection,w as BareWebSocket,n as WebSocketFields,p as WorkerConnection,d as browserSupportsTransferringStreams,k as default,e as maxRedirects,g as validProtocol};\n//# sourceMappingURL=index.mjs.map\n","const { assign } = Object;\n\nconst STORAGE = 'entries';\nconst READONLY = 'readonly';\nconst READWRITE = 'readwrite';\n\n/**\n * @typedef {Object} IDBMapOptions\n * @prop {'strict' | 'relaxed' | 'default'} [durability]\n * @prop {string} [prefix]\n */\n\n/** @typedef {[IDBValidKey, unknown]} IDBMapEntry */\n\n/** @type {IDBMapOptions} */\nconst defaultOptions = { durability: 'default', prefix: 'IDBMap' };\n\n/**\n * @template T\n * @param {{ target: IDBRequest<T> }} event\n * @returns {T}\n */\nconst result = ({ target: { result } }) => result;\n\nexport default class IDBMap extends EventTarget {\n  // Privates\n  /** @type {Promise<IDBDatabase>} */ #db;\n  /** @type {IDBMapOptions} */ #options;\n  /** @type {string} */ #prefix;\n\n  /**\n   * @template T\n   * @param {(store: IDBObjectStore) => IDBRequest<T>} what\n   * @param {'readonly' | 'readwrite'} how\n   * @returns {Promise<T>}\n   */\n  async #transaction(what, how) {\n    const db = await this.#db;\n    const t = db.transaction(STORAGE, how, this.#options);\n    return new Promise((onsuccess, onerror) => assign(\n      what(t.objectStore(STORAGE)),\n      {\n        onsuccess,\n        onerror,\n      }\n    ));\n  }\n\n  /**\n   * @param {string} name\n   * @param {IDBMapOptions} options\n   */\n  constructor(\n    name,\n    {\n      durability = defaultOptions.durability,\n      prefix = defaultOptions.prefix,\n    } = defaultOptions\n  ) {\n    super();\n    this.#prefix = prefix;\n    this.#options = { durability };\n    this.#db = new Promise((resolve, reject) => {\n      assign(\n        indexedDB.open(`${this.#prefix}/${name}`),\n        {\n          onupgradeneeded({ target: { result, transaction } }) {\n            if (!result.objectStoreNames.length)\n              result.createObjectStore(STORAGE);\n            transaction.oncomplete = () => resolve(result);\n          },\n          onsuccess(event) {\n            resolve(result(event));\n          },\n          onerror(event) {\n            reject(event);\n            this.dispatchEvent(event);\n          },\n        },\n      );\n    }).then(result => {\n      const boundDispatch = this.dispatchEvent.bind(this);\n      for (const key in result) {\n        if (key.startsWith('on'))\n          result[key] = boundDispatch;\n      }\n      return result;\n    });\n  }\n\n  // EventTarget Forwards\n  /**\n   * @param {Event} event\n   * @returns \n   */\n  dispatchEvent(event) {\n    const { type, message, isTrusted } = event;\n    return super.dispatchEvent(\n      // avoid re-dispatching of the same event\n      isTrusted ?\n        assign(new Event(type), { message }) :\n        event\n    );\n  }\n\n  // IDBDatabase Forwards\n  async close() {\n    (await this.#db).close();\n  }\n\n  // Map async API\n  get size() {\n    return this.#transaction(\n      store => store.count(),\n      READONLY,\n    ).then(result);\n  }\n\n  async clear() {\n    await this.#transaction(\n      store => store.clear(),\n      READWRITE,\n    );\n  }\n\n  /**\n   * @param {IDBValidKey} key\n   */\n  async delete(key) {\n    await this.#transaction(\n      store => store.delete(key),\n      READWRITE,\n    );\n  }\n\n  /**\n   * @returns {Promise<IDBMapEntry[]>}\n   */\n  async entries() {\n    const keys = await this.keys();\n    return Promise.all(keys.map(key => this.get(key).then(value => [key, value])));\n  }\n\n  /**\n   * @param {(unknown, IDBValidKey, IDBMap) => void} callback\n   * @param {unknown} [context]\n   */\n  async forEach(callback, context = this) {\n    for (const [key, value] of await this.entries())\n      await callback.call(context, value, key, this);\n  }\n\n  /**\n   * @param {IDBValidKey} key\n   * @returns {Promise<unknown | undefined>}\n   */\n  async get(key) {\n    const value = await this.#transaction(\n      store => store.get(key),\n      READONLY,\n    ).then(result);\n    return value;\n  }\n\n  /**\n   * @param {IDBValidKey} key\n   */\n  async has(key) {\n    const k = await this.#transaction(\n      store => store.getKey(key),\n      READONLY,\n    ).then(result);\n    return k !== void 0;\n  }\n\n  async keys() {\n    const keys = await this.#transaction(\n      store => store.getAllKeys(),\n      READONLY,\n    ).then(result);\n    return keys;\n  }\n\n  /**\n   * @param {IDBValidKey} key\n   * @param {unknown} value\n   */\n  async set(key, value) {\n    await this.#transaction(\n      store => store.put(value, key),\n      READWRITE,\n    );\n    return this;\n  }\n\n  async values() {\n    const keys = await this.keys();\n    return Promise.all(keys.map(key => this.get(key)));\n  }\n\n  get [Symbol.toStringTag]() {\n    return this.#prefix;\n  }\n}\n","import \"./scope.ts\";\nimport \"./api/eval.ts\";\nimport \"./api/fetch.ts\";\nimport \"./api/history.ts\";\nimport \"./api/websocket.ts\";\nimport \"./api/xmlhttprequest.ts\";\nimport \"./api/open.ts\";\nimport \"./api/postmessage.ts\";\nimport \"./api/navigator.ts\";\nimport \"./api/document.ts\";\nimport \"./api/worker.ts\";\nimport \"./api/importscripts.ts\";\nimport \"./api/element.ts\";\nimport \"./api/style.ts\";\nimport \"./api/cookie.ts\";\nimport \"./api/origin.ts\";\nimport \"./api/audio.ts\";\nimport \"./api/performance.ts\";\nimport \"./api/addeventlistener.ts\";\n"],"names":["window","Proxy","apply","target","thisArg","_param","type","func","argArray","wrappedFunc","event","Object","URL","self","Reflect","wrappedFunc1","parse","IDBMap","originalCookieDescriptor","Document","get","set","cookie","cookiesJar","cookies","_iteratorError","_$cookie","proxiedCookie","document","value","originalDocumentbaseURI","originalDocumentdocumentURI","originalDocumentreferrer","originalDocumentURL","createDocumentProxy","createWindowProxy","htmlElements","Set","urlAttributes","deleteAttributes","srcSetAttributes","htmlAttributes","cssAttributes","javascriptAttributes","allAttributes","Node","originalElementInnerHTML","Element","_instanceof","HTMLScriptElement","HTMLStyleElement","originalElementInnerText","originalElementHasAttribute","HTMLElement","attribute","originalElementGetAttribute","originalElementSetAttribute","name","originalElementRemoveAttribute","originalElementGetAttributeNames","attributes","attr","htmlElement","_iteratorError1","originalContentWindow","HTMLIFrameElement","originalContentDocument","construct","arg","_type_of","Array","originalGetEntriesByType","entries","entry","originalElementStyle","styles","property","urlRegex","match","url","originalGetProperty","CSSStyleDeclaration","BareClient","client","args","navigator","ArrayBuffer","Worklet","createLocationProxy","doc","prop","newValue","loc","_target","decodedLocation","scope","identifier","globals","global","Location","win"],"mappings":";;;;AAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,qCAAqC;;AAErC;AACA;AACA;AACA;;AAEA;AACA,sBAAsB;AACtB;;AAEA;AACA,sEAAsE;AACtE,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC,IAAI;AACJ;AACA;;AAEA,WAAW;AACX;;AAEA;AACA;AACA,sBAAsB;AACtB;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,oMAAoM,cAAc;AAClN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,kCAAkC;AAClC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,uEAAuE;AACvE;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,+CAA+C;AAC/C;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,cAAc;AACd,oBAAoB;AACpB,0BAA0B;AAC1B,iCAAiC;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AAU,UAAU;;AAEvB;AACf;AACA,aAAa,sBAAsB;AACnC,aAAa,eAAe;AAC5B,aAAa,QAAQ;;AAErB;AACA;AACA,aAAa,0CAA0C;AACvD,aAAa,0BAA0B;AACvC,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,QAAQ;AACrB,aAAa,eAAe;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,0BAA0B,aAAa,GAAG,KAAK;AAC/C;AACA,4BAA4B,UAAU,uBAAuB;AAC7D;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA,YAAY,2BAA2B;AACvC;AACA;AACA;AACA,kCAAkC,SAAS;AAC3C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,wCAAwC;AACrD,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,aAAa;AAC1B,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,aAAa;AAC1B,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3MoB;AACG;AACC;AACE;AACE;AACK;AACV;AACO;AACF;AACD;AACF;AACO;AACN;AACF;AACC;AACA;AACD;AACM;AACK"}
